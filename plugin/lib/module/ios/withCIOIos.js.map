{"version":3,"names":["withAppDelegateSwiftModifications","withCioXcodeProject","withCioNotificationsXcodeProject","withGoogleServicesJsonFile","withCIOIos","config","props","cioProps","mergeDeprecatedPropertiesAndLogWarnings","pushNotification","deprecatedTopLevelProperties","showPushAppInForeground","autoTrackPushEvents","handleDeeplinkInKilledState","disableNotificationRegistration","autoFetchDeviceToken","Object","entries","forEach","key","value","undefined","console","warn","propKey"],"sources":["withCIOIos.ts"],"sourcesContent":["import type { ExpoConfig } from '@expo/config-types';\n\nimport type {\n  CustomerIOPluginOptionsIOS,\n  CustomerIOPluginPushNotificationOptions,\n} from '../types/cio-types';\n// import { withAppDelegateModifications } from './withAppDelegateModifications';\nimport { withAppDelegateSwiftModifications } from './withAppDelegateSwiftModifications';\nimport { withCioXcodeProject } from './withXcodeProject';\nimport { withCioNotificationsXcodeProject } from './withNotificationsXcodeProject';\nimport { withGoogleServicesJsonFile } from './withGoogleServicesJsonFile';\n\nexport function withCIOIos(\n  config: ExpoConfig,\n  props: CustomerIOPluginOptionsIOS\n) {\n  const cioProps = mergeDeprecatedPropertiesAndLogWarnings(props);\n  if (cioProps.pushNotification) {\n    // config = withAppDelegateModifications(config, cioProps);\n    config = withAppDelegateSwiftModifications(config, cioProps);\n    config = withCioNotificationsXcodeProject(config, cioProps);\n    config = withCioXcodeProject(config, cioProps);\n    config = withGoogleServicesJsonFile(config, cioProps);\n  }\n\n  return config;\n}\n\n/**  The basic purpose of this function is to centralize where we handle the deprecation\n  by merging the deprecated properties into the new ios.pushNotification.* properties\n  and logging a warning if they are set. This way, we can remove the deprecated properties\n  from the top level of the ios object in the future, and update this function\n  while the rest of the plugin code remains unchanged.\n*/\nconst mergeDeprecatedPropertiesAndLogWarnings = (\n  props: CustomerIOPluginOptionsIOS\n) => {\n  // The deprecatedTopLevelProperties maps the top level properties\n  // that are deprecated to the new ios.pushNotification.* properties\n  // that should be used instead. The deprecated properties are\n  // still available for backwards compatibility, but they will\n  // be removed in the future.\n\n  const deprecatedTopLevelProperties = {\n    showPushAppInForeground: props.showPushAppInForeground,\n    autoTrackPushEvents: props.autoTrackPushEvents,\n    handleDeeplinkInKilledState: props.handleDeeplinkInKilledState,\n    disableNotificationRegistration: props.disableNotificationRegistration,\n    autoFetchDeviceToken: props.autoFetchDeviceToken,\n  };\n\n  // loop over all the deprecated properties and log a warning if they are set\n  Object.entries(deprecatedTopLevelProperties).forEach(([key, value]) => {\n    if (value !== undefined) {\n      console.warn(\n        `The ios.${key} property is deprecated. Please use ios.pushNotification.${key} instead.`\n      );\n\n      if (props.pushNotification === undefined) {\n        props.pushNotification = {} as CustomerIOPluginPushNotificationOptions;\n      }\n      const propKey = key as keyof CustomerIOPluginPushNotificationOptions;\n      if (props.pushNotification[propKey] === undefined) {\n        props.pushNotification = {\n          ...props.pushNotification,\n          [propKey]: value,\n        };\n      } else {\n        console.warn(\n          `The ios.${key} property is deprecated. Since the value of ios.pushNotification.${key} is set, it will be used.`\n        );\n      }\n    }\n  });\n\n  return props;\n};\n"],"mappings":"AAMA;AACA,SAASA,iCAAiC,QAAQ,qCAAqC;AACvF,SAASC,mBAAmB,QAAQ,oBAAoB;AACxD,SAASC,gCAAgC,QAAQ,iCAAiC;AAClF,SAASC,0BAA0B,QAAQ,8BAA8B;AAEzE,OAAO,SAASC,UAAUA,CACxBC,MAAkB,EAClBC,KAAiC,EACjC;EACA,MAAMC,QAAQ,GAAGC,uCAAuC,CAACF,KAAK,CAAC;EAC/D,IAAIC,QAAQ,CAACE,gBAAgB,EAAE;IAC7B;IACAJ,MAAM,GAAGL,iCAAiC,CAACK,MAAM,EAAEE,QAAQ,CAAC;IAC5DF,MAAM,GAAGH,gCAAgC,CAACG,MAAM,EAAEE,QAAQ,CAAC;IAC3DF,MAAM,GAAGJ,mBAAmB,CAACI,MAAM,EAAEE,QAAQ,CAAC;IAC9CF,MAAM,GAAGF,0BAA0B,CAACE,MAAM,EAAEE,QAAQ,CAAC;EACvD;EAEA,OAAOF,MAAM;AACf;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMG,uCAAuC,GAC3CF,KAAiC,IAC9B;EACH;EACA;EACA;EACA;EACA;;EAEA,MAAMI,4BAA4B,GAAG;IACnCC,uBAAuB,EAAEL,KAAK,CAACK,uBAAuB;IACtDC,mBAAmB,EAAEN,KAAK,CAACM,mBAAmB;IAC9CC,2BAA2B,EAAEP,KAAK,CAACO,2BAA2B;IAC9DC,+BAA+B,EAAER,KAAK,CAACQ,+BAA+B;IACtEC,oBAAoB,EAAET,KAAK,CAACS;EAC9B,CAAC;;EAED;EACAC,MAAM,CAACC,OAAO,CAACP,4BAA4B,CAAC,CAACQ,OAAO,CAAC,CAAC,CAACC,GAAG,EAAEC,KAAK,CAAC,KAAK;IACrE,IAAIA,KAAK,KAAKC,SAAS,EAAE;MACvBC,OAAO,CAACC,IAAI,CACV,WAAWJ,GAAG,4DAA4DA,GAAG,WAC/E,CAAC;MAED,IAAIb,KAAK,CAACG,gBAAgB,KAAKY,SAAS,EAAE;QACxCf,KAAK,CAACG,gBAAgB,GAAG,CAAC,CAA4C;MACxE;MACA,MAAMe,OAAO,GAAGL,GAAoD;MACpE,IAAIb,KAAK,CAACG,gBAAgB,CAACe,OAAO,CAAC,KAAKH,SAAS,EAAE;QACjDf,KAAK,CAACG,gBAAgB,GAAG;UACvB,GAAGH,KAAK,CAACG,gBAAgB;UACzB,CAACe,OAAO,GAAGJ;QACb,CAAC;MACH,CAAC,MAAM;QACLE,OAAO,CAACC,IAAI,CACV,WAAWJ,GAAG,oEAAoEA,GAAG,2BACvF,CAAC;MACH;IACF;EACF,CAAC,CAAC;EAEF,OAAOb,KAAK;AACd,CAAC","ignoreList":[]}